<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마이페이지</title>
    <style>
        body { font-family: system-ui, sans-serif; max-width: 800px; margin: 0 auto; padding: 2rem; }
        h1 { margin-bottom: 1rem; }
        h2 { margin: 1.5rem 0 0.75rem 0; font-size: 1.1rem; }
        a { color: #2563eb; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .nav { margin-bottom: 1.5rem; }
        .nav a { margin-right: 1rem; }
        .profile { background: #f8fafc; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem; }
        .profile p { margin: 0.25rem 0; }
        .item { border: 1px solid #e2e8f0; border-radius: 8px; padding: 1rem; margin-bottom: 0.75rem; }
        .item h3 { margin: 0 0 0.5rem 0; font-size: 1rem; }
        .item p { margin: 0; color: #64748b; font-size: 0.9rem; }
        .message { color: #059669; margin-bottom: 1rem; }
    </style>
</head>
<body>
    <nav class="nav">
        <a th:href="@{/}">← 지도</a>
        <a th:href="@{/me/edit}">개인정보 수정</a>
        <a th:href="@{/about}">About</a>
    </nav>

    <p th:if="${message}" class="message" th:text="${message}"></p>
    <h1>마이페이지</h1>

    <section class="profile" th:if="${member}">
        <p><strong th:text="${member.nickname}">닉네임</strong></p>
        <p th:text="${member.email}">이메일</p>
    </section>

    <section th:if="${posts != null and !posts.empty}">
        <h2>내 게시글</h2>
        <div th:each="post : ${posts.content}" class="item">
            <h3><a th:href="@{/posts/{id}(id=${post.id})}" th:text="${post.title}">제목</a></h3>
            <p th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}">작성일</p>
        </div>
    </section>

    <section th:if="${imagePosts != null and !imagePosts.empty}">
        <h2>내 이미지 게시글</h2>
        <div th:each="ip : ${imagePosts.content}" class="item">
            <h3><a th:href="@{/image-posts/{id}(id=${ip.id})}" th:text="${ip.title}">제목</a></h3>
            <p th:text="${#temporals.format(ip.createdAt, 'yyyy-MM-dd HH:mm')}">작성일</p>
        </div>
    </section>

    <section th:if="${pins != null and !pins.empty}">
        <h2>내 Pin</h2>
        <div th:each="pin : ${pins.content}" class="item">
            <h3><a th:href="@{/pins/{id}/posts(id=${pin.id})}" th:text="${(pin.description != null and !pin.description.isEmpty()) ? pin.description : 'Pin #' + pin.id}">Pin</a></h3>
            <p th:text="'위도 ' + ${pin.latitude} + ', 경도 ' + ${pin.longitude}">위치</p>
        </div>
    </section>

    <p th:if="${(posts == null or posts.empty) and (imagePosts == null or imagePosts.empty) and (pins == null or pins.empty)}">
        아직 작성한 글이 없습니다. <a th:href="@{/posts/create}">게시글 작성</a> | <a th:href="@{/image-posts/create}">이미지 작성</a>
    </p>
</body>
</html>
